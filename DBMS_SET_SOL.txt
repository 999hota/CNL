--------SET 1-----------
CREATE TABLE EMP(
EMP_NO NUMBER(10) PRIMARY KEY,
EMP_NAME VARCHAR2(20),
JOB VARCHAR2(20) 
MGR NUMBER(10),
HIREDATE DATE,
SAL NUMBER(10),
COMM NUMBER(10),
DEPTNO NUMBER(10));

1. SELECT EMP_NO,EMP_NAME WHERE HIREDATE IN('1-MAY-81','31-DEC-81','17-DEC-81,'19-JAN-80')
ORDER BY HIREDATE ASC;

2. SELECT * FROM EMP WHERE SAL=(SELECT MAX(SAL) FROM EMP);
SELECT * FROM EMP WHERE SAL=(SELECT MIN(SAL) FROM EMP);

3. SELECT EMP_NAME WHERE SAL>=22000 AND SAL<=45000;

4. SELECT EMP_NAME FROM EMP WHERE EMP_NAME LIKE '_____';

5. SELECT EMP_NAME FROM EMP WHERE EMP_NAME LIKE '__S_';

6. SELECT EMP_NAME FROM EMP WHERE TO_CHAR(HIREDATE,'MON')='JAN';

7. SELECT EMP_NAME FROM EMP WHERE NAME LIKE '%LL%' OR NAME LIKE 'LL%' OR NAME LIKE '%LL';

8. SELECT EMP_NAME WHERE HIREDATE BETWEEN '1-JAN-80' AND '1-JAN-99';


-----------SET 2-------------
1. SELECT DISTINCT JOB FROM EMP;

2. SELECT * FROM EMP ORDER BY SAL ASC;

3. SELECT DISTINCT(JOB) FROM EMP ORDER BY JOB DESC;

4. SELECT * FROM EMP WHERE JOB LIKE 'MANAGER';

5. SELECT EMP_NAME WHERE HIREDATE=(SELECT MAX(HIREDATE) FROM EMP);

6. SELECT EMPNO,EMP_NAME,SAL,SAL/30 AS DAILY_SAL ORDER BY SAL DESC;

7. SELECT EMPNO,EMP_NAME FROM EMP WHERE JOB LIKE 'MANAGER';

8. SELECT * FROM EMP WHERE SAL=(SELECT MAX(SAL) FROM EMP WHERE SAL<>(SELECT MAX(SAL) FROM EMP);


--------------SET 3----------------
CREATE TABLE EMP(
EMP_NO NUMBER(10) PRIMARY KEY,
EMP_NAME VARCHAR2(20),
JOB VARCHAR2(20) 
MGR NUMBER(10),
HIREDATE DATE,
SAL NUMBER(10),
COMM NUMBER(10),
DEPTNO NUMBER(10) REFERENCES DEPT(DEPTNO));

CREATE TABLE DEPT(
DEPTNO NUMBER(10) PRIMARY KEY,
DNAME VARCHAR2(20),
LOC VARCHAR2(20));

1. SELECT EMP_NAME FROM EMP WHERE HIREDATE=(SELECT MAX(HIREDATE) FROM EMP) AND
DEPTNO=(SELECT DEPTNO FROM DEPT WHERE LOC LIKE 'KOLKATA' AND DNAME LIKE 'HRD');

2. SELECT DNAME, COUNT(EMP_NAME) FROM EMP NATURAL JOIN DEPT GROUP BY DNAME;

3. SELECT * FROM EMP WHERE DEPTNO=20 AND SAL>(SELECT AVG(SAL) FROM EMP WHERE DEPTNO=10);

4. SELECT * FROM DEPT 
WHERE DEPTNO IN(SELECT DEPTNO FROM EMP
	GROUP BY DEPTNO 
		HAVING COUNT(*) IN(SELECT MAX(MYCOUNT) FROM 
			(SELECT COUNT *)))

5. SELECT EMP_NAME FROM EMP WHERE DEPTNO NOT IN(SELECT DEPTNO FROM DEPT WHERE DNAME LIKE 'SALES');

6. SELECT E.EMP_NAME,D.DNAME,E.SAL,E.COMM FROM EMP E, DEPT D WHERE E.SAL BETWEEN 2000 AND 5000
AND E.DEPTNO IN(SELECT DEPTNO FROM DEPT WHERE LOC LIKE 'KOLKATA');

7. SELECT EMP_NAME,JOB,DNAME, LOC FROM EMP NATURAL JOIN DEPT WHERE JOB LIKE 'MANAGER';

8. SELECT EMP_NAME,JOB,SAL,DNAME FROM EMP NATURAL JOIN DEPT WHERE DNAME<>'CLERK' ORDER BY SAL DESC;


--------SET 4-----------
create table Customer(
cust_id number(8) primary key check (cust_id>=100 and cust_id<=10000), 
cust_name varchar2(20), 
annual_revenue number(10), 
cust_type varchar2(15) check(cust_type in ('MANUFACTURER','WHOLESALER','RETAILER')));

CREATE TABLE CITY(
CITY_NAME VARCHAR2(20) PRIMARY KEY,
POPULATION NUMBER(30));

CTREATE TABLE TRUCK(
TRUCK_NO NUMBER(10) PRIMARY KEY,
DRIVER_NAME VARCHAR(20));

CREATE TABLE SHIPMENT(
SHIPMENT_NO NUMBER(10),
CUST_ID NUMBER(10),
WEIGHT NUMBER(5) CHECK(WEIGHT<1000),
TRUCK_NO NUMBER(10),
DESTINATION VARCHAR2(20),
SHIP_DATE DATE,
PRIMARY KEY (SHIPMENT_NO,CUST_ID),
FOREIGN KEY CUST_ID REFERENCES CUSTOMER(CUST_ID) ON DELETE CASCADE,
FOREIGN KEY DESTINATION REFERENCES CITY(CITY_NAME),
FOREIGN KEY TRUCK_NO REFERENCES TRUCK(TRUCK_NO));

1. SELECT CUST_NAME FROM CUSTOMER 
	WHERE CUST_ID IN(SELECT CUST_ID FROM SHIPMENT 
					WHERE DESTINATION IN ('KOLKATA','CHENNAI','MUMBAI'));

2. SELECT DRIVER_NAME FROM TRUCK 
	WHERE TRUCK_NO IN(SELECT TRUCK_NO FROM SHIPMENT WHERE WEIGHT>200);

3. SELECT MAX(WEIGHT) AS "MAX_WEIGHT", MIN(WEIGHT) AS "MIN_WEIGHT" FROM SHIPMENT;

4. SELECT CUST_ID,AVG(WEIGHT) FROM SHIPMENT GROUP BY CUST_ID;

5. SELECT CITY_NAME,POPULATION FROM CITY 
	WHERE CITY_NAME IN(SELECT DESTINATION FROM SHIPMENT 
		GROUP BY DESTINATION HAVING SUM(WEIGHT)>100);


---------------SET 5---------------
create table Customer(
cust_id number(8) primary key check (cust_id>=100 and cust_id<=10000), 
cust_name varchar2(20), 
annual_revenue number(10), 
cust_type varchar2(15) check(cust_type in ('MANUFACTURER','WHOLESALER','RETAILER')));

CREATE TABLE CITY(
CITY_NAME VARCHAR2(20) PRIMARY KEY,
POPULATION NUMBER(30));

CTREATE TABLE TRUCK(
TRUCK_NO NUMBER(10) PRIMARY KEY,
DRIVER_NAME VARCHAR(20));

CREATE TABLE SHIPMENT(
SHIPMENT_NO NUMBER(10),
CUST_ID NUMBER(10),
WEIGHT NUMBER(5) CHECK(WEIGHT<1000),
TRUCK_NO NUMBER(10),
DESTINATION VARCHAR2(20),
SHIP_DATE DATE,
PRIMARY KEY (SHIPMENT_NO,CUST_ID),
FOREIGN KEY CUST_ID REFERENCES CUSTOMER(CUST_ID) ON DELETE CASCADE,
FOREIGN KEY DESTINATION REFERENCES CITY(CITY_NAME),
FOREIGN KEY TRUCK_NO REFERENCES TRUCK(TRUCK_NO));

1. SELECT MAX(WEIGHT) FROM SHIPMENT GROUP BY DESTINATION;

2. SELECT CUST_NAME, ANNUAL_REVENUE FROM CUSTOMER
	WHERE CUST_ID IN(SELECT CUST_ID FROM SHIPMENT
		WHERE TRUCK_ID IN(SELECT TRUCK_ID FROM TRUCK
			WHERE DRIVER_NAME LIKE 'BARUN'));

3. select drivername from truck where(select count(Distinct(destination)) from shipment where shipment.truckno=truck,truckno)=(select count(cityname)from truck)
)

4. SELECT MIN(WEIGHT) FROM SHIPMENT 
	WHERE DESTINATION IN(SELECT CITY_NAME FROM CITY 
		GROUP BY CITY_NAME HAVING POPULATION>100000);

5. 


---------------SET 6-------------------
CREATE TABLE EMP(
EMP_NO NUMBER(10) PRIMARY KEY,
EMP_NAME VARCHAR2(20),
JOB VARCHAR2(20) 
MGR NUMBER(10),
HIREDATE DATE,
SAL NUMBER(10),
COMM NUMBER(10),
DEPTNO NUMBER(10));

1. SELECT EMP_NAME WHERE COMM IS NULL;

2. SELECT EMP_NAME FROM EMP WHERE JOB NOT IN('PRESIDENT','MANAGER') ORDER BY SAL ASC;

3. SELECT * FROM EMP WHERE HIREDATE<'1-jan-81' OR HIREDATE>'1-JAN-81';

4. SELECT * FROM EMP WHERE MGR IS NOT NULL;

5. SELECT EMP_NAME FROM EMP WHERE TO_CHAR(TO_DATE(HIREDATE,'MM-DD-YYYY'))='JUNE-4-1988';

6. SELECT MGR FROM EMP GRP BY MGR HAVING COUNT(*)=(SELECT MAX(COUNT(*)) FROM EMP GRP BY MGR);

7. SELECT AVG(SAL) AS "AVERAGE SALARY" FROM EMP GROUP BY DEPTNO;

8. SELECT * FROM EMP 
	WHERE SAL IN(SELECT MAX(SAL) FROM EMP 
		WHERE SAL<>(SELECT MAX(SAL) FROM EMP));






























